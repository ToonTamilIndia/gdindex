# GDIndex Cloudflare Worker Configuration
# https://developers.cloudflare.com/workers/wrangler/configuration/

name = "index"
main = "index.js"
compatibility_date = "2024-01-01"

# Enable Node.js compatibility for crypto operations
compatibility_flags = ["nodejs_compat"]

# Account ID (optional - wrangler will prompt if not set)
# account_id = "your-account-id"

# Workers Paid plan enables more features
# usage_model = "bundled"

# ============================================
# Environment Variables (non-sensitive)
# ============================================
[vars]
ENVIRONMENT = "production"
# DEBUG = "false"

# ============================================
# KV Namespaces
# Required for Auth0 session storage
# ============================================
# Create with: wrangler kv:namespace create "AUTH_STORE"
# Then uncomment and add the ID:

# [[kv_namespaces]]
# binding = "AUTH_STORE"
# id = "your-kv-namespace-id"

# Preview namespace for wrangler dev
# [[kv_namespaces]]
# binding = "AUTH_STORE"
# id = "your-preview-namespace-id"
# preview_id = "your-preview-namespace-id"

# ============================================
# Custom Domains / Routes
# ============================================
# Uncomment and configure for custom domain:

# routes = [
#   { pattern = "files.yourdomain.com/*", zone_name = "yourdomain.com" }
# ]

# Or use workers.dev subdomain (default)
# workers_dev = true

# ============================================
# Cron Triggers (if needed)
# ============================================
# [triggers]
# crons = ["0 0 * * *"]  # Daily at midnight

# ============================================
# Build Configuration
# ============================================
# For bundled builds (esbuild, webpack, etc.)
# [build]
# command = "npm run build"
# [build.upload]
# format = "modules"

# ============================================
# Development Settings
# ============================================
[dev]
port = 8787
local_protocol = "http"
# ip = "0.0.0.0"  # Uncomment to expose to network

# ============================================
# Staging Environment
# ============================================
# [env.staging]
# name = "gdindex-staging"
# vars = { ENVIRONMENT = "staging" }
# routes = [
#   { pattern = "staging-files.yourdomain.com/*", zone_name = "yourdomain.com" }
# ]

# ============================================
# Production Environment
# ============================================
# [env.production]
# name = "gdindex"
# vars = { ENVIRONMENT = "production" }
# routes = [
#   { pattern = "files.yourdomain.com/*", zone_name = "yourdomain.com" }
# ]

# ============================================
# Durable Objects (Advanced - for persistent state)
# ============================================
# [[durable_objects.bindings]]
# name = "SESSIONS"
# class_name = "SessionDO"

# [[migrations]]
# tag = "v1"
# new_classes = ["SessionDO"]

# ============================================
# R2 Storage (if using R2 for caching)
# ============================================
# [[r2_buckets]]
# binding = "CACHE_BUCKET"
# bucket_name = "gdindex-cache"

# ============================================
# Analytics Engine (for usage tracking)
# ============================================
# [[analytics_engine_datasets]]
# binding = "ANALYTICS"

# ============================================
# Secrets (set via CLI, not in this file)
# ============================================
# Set secrets with:
#   wrangler secret put GOOGLE_CLIENT_SECRET
#   wrangler secret put GOOGLE_REFRESH_TOKEN
#   wrangler secret put DASHBOARD_PASSWORD
#   wrangler secret put AUTH0_CLIENT_SECRET
#
# Access in code via: env.GOOGLE_CLIENT_SECRET
